# 关于机床参数的设置

## 前言

这里仅对一些常用的参数进行说明，详细方式以及冲突请参考培训文档



## 案例

测试台一体机，配置XYZC4个轴，KV为4，XYZ为直线轴，电机旋转一圈，XZ轴丝杆导程为5mm，6mm，Y轴为齿轮齿条结构，齿轮齿数18，模式2，螺旋角19度38分42秒，C为最短路径旋转轴，减速比3比1，减速，4个轴都要求回零，先回Y，再回Z，最后回XC，回零要求回完成后，XYZ的电机键槽超正上，坐标0，C轴键槽朝正上，坐标180，所有轴电机最大速度6000转/分，电机每转脉冲数是32768（4倍频后），回零信号用继电器模块的C1-C4。要求使用原生的机床参数编辑器。

**关键词**： 

- KV 
- 丝杆导程
- 齿轮滚条结构
- 回零顺序
- 要求回零
- 键帽朝上

必须设置的参数：

1. 最大速度    **AxisSpeedMaxAppl**
   1. 最大速度 = 电机转速*电机旋转一圈的距离 *减速比
2. 速度环增益    **GainSpeedFacto**r****
   1. 速度环增益.=最大速度.*1.25 /kv
   2. 所以其实通过速度环增益可以设置出kv
3. 脉冲当量   **MachToInternaIIncr**
4. 旋转一圈的脉冲数     **MachInrementsPerRev**
   1. 一般来说就是电机控制器的脉冲频率,但是对于**旋转轴=360000/脉冲当量**
5. CharacterApplTab-----这个参数第五个位置用来设置不同的XYZ轴对应的轴顺序，**需要从零开始配置**，第六位为轴的类型（直线轴或者旋转轴）

## 对于案例的正确做法

### **AxisSpeedMaxAppl**

XZ的丝杆导程分别为5、6，电机转速为6000，所以分别设置为24000 28800，有减速比的需要乘以减速比比如上述的C轴

### **GainSpeedFacto**r

得到最大速度以及KV就可以计算了，XZ轴分别为**最大速度*1.25/kv** ,为7500、9000

### **MachToInternaIIncr**

脉冲当量影响机床读取到的真实移动距离反馈值。单位为um

XZ轴分别为5000/32768 、6000/32768

### **AxisSequence**

回零顺序设置 ：

						1. AxisSequence(1)=2#0010 第二个轴先回零
						2.AxisSequence(2)=2#0100	第三个轴回零
	      				3. AxisSequence(3)=2#1001	第一个和第四个一起回零
根据位来决定返回顺序



### **RefPositionDistance**

回零点找到之后再移动的距离。由此参数可以设置键帽朝向

### **RefPositionValue**

回零之后界面上显示的值。

RefPositionValue(4)= 180000

### **齿轮齿条结构的计算**

有效导程  = 分度圆直径*PAI/cos(b)

分度圆直径= M*Z = **模数**乘以**齿数**

单位是毫米，

**注**：这里有效导程相当于丝杆导程，也就是轴旋转一圈实际走的距离

### **MachInrementsPerRev**

C轴需要特殊设置 360000/**MachToInternaIIncr**



## 总结

最大速度与速度环增益的设置会影响KV的值，KV的大小决定了速度环调节的响应，脉冲当量决定了机床对于实际旋转移动距离的反馈，比如转了一圈的实际位移，MachInrementsPerRev轴旋转一圈的脉冲这个对于旋转轴有特殊的要求，具体为什么我也不太清楚。

## 问题

### 一体机上手动连续或者点动，按键上对应的轴与实际旋转轴不一致

需要在PLC程序中修改按键对应的轴顺序，比如说只有四个轴，第四个轴对应的是C轴，默认一般情况是A轴为第四轴，所以需要在程序中将C轴的按键设置为第四轴。

### 一体机上部分轴不旋转

或许需要到位置文件中去修改，文件位置为`Power Automation\User data\DriveCfg.ini`将需要的轴添加到上面.

**还有一种情况是对应轴的液压锁没有打开**，可以到PLC程序中查看对应的轴是否有液压锁设置，最简单的方式是在按键上看一下有没有对应的液压锁开关按键按一下试试，如果不行再到程序中去查看对应轴。

### 轴旋转一小会儿之后报警

这种情况需要检查一下前面写的几个变量值有没有设置正确，脉冲当量、速度环、最大速度。比如旋转一圈的最大速度值与脉冲当量在脉冲次数上的积分出现大的差异。其实就是值对应不上了。

